{% extends "base.html"%}
{% block title %} Dashboard {% endblock %}
{% block head %}
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.6.0/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.13.1/underscore-umd-min.js"></script>
    <script src="../static/js/charts.js" type="text/javascript"></script>
    <script src="../static/js/map.js" type="text/javascript"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key={{API_KEY}}&callback=initMap"></script>
{% endblock %}
{% block body %}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h1>A Tale of Two Cents</h1>

            {% if missed == None %}

                <h3><span id="year">{{year}}</span> Years Info for <span id="missed">Missed and Found Money</span></h3>

            {% elif missed == "both" %}

                <h3><span id="year">{{year}}</span> Info for <span id="missed">Missed and Found Money</span></h3>

            {% elif missed == "found" %}
                <h3><span id="year">{{year}}</span> Info for <span id="missed">Found Money</span></h3>
        
            {% elif missed == "missed" %}
                <h3><span id="year">{{year}}</span> Info for <span id="missed">Missed Money</span></h3>
            {% endif %}
        </div>
    </div>
    <div class="row">
        <div class="col-3">
            <form action="/dashboard">
                <label for="years">Filter Your Tale</label>
                <br>
                    <select name="years" >
                        <option value="All" class="year">All Years</option>
                        {% for year in years_list %}
                            <option value={{year}} class="year">{{year}}</option>
                        {%endfor%}
                    </select>
                    <select name="missed">
                        <option value="both" class="missed">Both Missed & Found</option>
                        <option value="found" class="missed">Found</option>
                        <option value="missed" class="missed">Missed</option>
                      
                    </select>
                    <input type="submit">
                </form>

            <br>
            Grand Total: {{ "$%.2f"|format(total_found + total_missed)}}
            <br>
            You Found: {{ "$%.2f"|format(total_found) }} 
            <br>
            You Missed: {{ "$%.2f"|format(total_missed) }} 
                <br>
            {% if day_avg == 'N/A' %}
                A Daily Average: {{day_avg}}
            {% else %}
                A daily Average: {{ "$%.3f"|format(day_avg) }}
            {% endif %}
            <br>
            <h3>Most Frequents</h3>
            Coin/Bill: {{money_type}} <br>
            Coin/Bill Count: {{type_count}} <br>
            <!-- Set up condition to only show this if missed is NOT selected, as this information is not available for missed money -->
            {% if missed != "missed" %}
            Coin/Bill Year: {{money_year}} <br>
            Coin/Bill Year Count: {{money_count}}<br>
            {%endif%}
            Day of the Week: {{dow}}
            <!-- Set up condition to only show this if missed is NOT selected, as this information is not available for missed money -->
            <!-- {% if missed != 'missed' %}
            <span>The most frequent year of a coin/bill is {{ money_year }} and it was found {{ money_count }} times!</span>
            {% endif %}
            <br>
            The most frequent coin/bill is {{ money_type }} and it has been found {{ type_count }} times!
            <br>
            The Most Freq day of the week is: {{ dow }} -->

        </div>
        <div class="col-9">
            <canvas id="stackedbar"></canvas>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div id="map">
            </div>
        </div>
    </div>
</div>
{% endblock %}
